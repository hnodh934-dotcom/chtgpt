#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ุฅุตูุงุญ ุงููููุงุช ุงููุงูุตุฉ ูุชุญุฏูุซ ุงููุนูููุงุช ุงููุงููููุฉ
"""

from openpyxl import Workbook, load_workbook
from openpyxl.styles import Font, PatternFill, Border, Side, Alignment
from openpyxl.utils import get_column_letter
from openpyxl.worksheet.datavalidation import DataValidation
import os

# ุงูุฅุนุฏุงุฏุงุช
GREEN = "1B5E4A"
GOLD = "C9A227"
HEADER_FILL = PatternFill(start_color=GREEN, end_color=GREEN, fill_type="solid")
HEADER_FONT = Font(name='Arial', size=12, bold=True, color="FFFFFF")
TITLE_FONT = Font(name='Arial', size=16, bold=True, color=GREEN)
SUBTITLE_FONT = Font(name='Arial', size=14, bold=True, color=GOLD)
NORMAL_FONT = Font(name='Arial', size=11)
THIN_BORDER = Border(left=Side(style='thin'), right=Side(style='thin'),
                     top=Side(style='thin'), bottom=Side(style='thin'))
RTL_ALIGN = Alignment(horizontal='right', vertical='center', wrap_text=True)
CENTER_ALIGN = Alignment(horizontal='center', vertical='center', wrap_text=True)

def style_header(ws, row, cols):
    for col in range(1, cols + 1):
        cell = ws.cell(row=row, column=col)
        cell.fill = HEADER_FILL
        cell.font = HEADER_FONT
        cell.border = THIN_BORDER
        cell.alignment = CENTER_ALIGN

def set_widths(ws, widths):
    for i, w in enumerate(widths, 1):
        ws.column_dimensions[get_column_letter(i)].width = w

def add_data(ws, start_row, data):
    for row_idx, row_data in enumerate(data, start_row):
        for col_idx, value in enumerate(row_data, 1):
            cell = ws.cell(row=row_idx, column=col_idx, value=value)
            cell.border = THIN_BORDER
            cell.alignment = RTL_ALIGN if col_idx > 1 else CENTER_ALIGN
            cell.font = NORMAL_FONT

def create_current_status():
    """ุฅูุดุงุก ููู ุงูุญุงูุฉ ุงูุฑุงููุฉ"""
    wb = Workbook()

    # ===== ูุฑูุฉ 1: ุณุฌู ุงููุฎุงููุงุช =====
    ws1 = wb.active
    ws1.title = "ุณุฌู ุงููุฎุงููุงุช"
    ws1.sheet_view.rightToLeft = True

    ws1.merge_cells('A1:J1')
    ws1['A1'] = "ุณุฌู ุงููุฎุงููุงุช ูุงูููุงุญุธุงุช ุงูุฑูุงุจูุฉ"
    ws1['A1'].font = TITLE_FONT
    ws1['A1'].alignment = CENTER_ALIGN

    headers = ['ู', 'ุฑูู ุงููุฎุงููุฉ', 'ุงูุชุงุฑูุฎ', 'ุงูุฌูุฉ', 'ุงูููุน', 'ุงููุตู', 'ุงููุงุฏุฉ ุงููุธุงููุฉ', 'ุงูุบุฑุงูุฉ', 'ุงูุญุงูุฉ', 'ุชุงุฑูุฎ ุงูุชุตุญูุญ']
    for col, h in enumerate(headers, 1):
        ws1.cell(row=3, column=col, value=h)
    style_header(ws1, 3, len(headers))

    violations = [
        [1, 'VIO-2024-001', '2024-01-15', 'SFDA', 'ุณูุงูุฉ ุบุฐุงุฆูุฉ', 'ุนุฏู ูุฌูุฏ ูุธุงู HACCP', 'ุงููุงุฏุฉ 15', 50000, 'ูุงุฆูุฉ', ''],
        [2, 'VIO-2024-002', '2024-01-15', 'SFDA', 'ูุธุงูุฉ', 'ูุตูุฑ ูุนุงููุฑ ุงููุธุงูุฉ', 'ุงููุงุฏุฉ 12', 25000, 'ูุงุฆูุฉ', ''],
        [3, 'VIO-2024-003', '2024-02-01', 'ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ', 'ุนูุงููุฉ', 'ุนุฏู ุชูุซูู ุงูุนููุฏ', 'ุงููุงุฏุฉ 51', 10000, 'ูุงุฆูุฉ', ''],
        [4, 'VIO-2024-004', '2024-02-10', 'ุงูุฏูุงุน ุงููุฏูู', 'ุณูุงูุฉ', 'ุงูุชูุงุก ุทูุงูุงุช ุงูุญุฑูู', 'ูุงุฆุญุฉ ุงูุณูุงูุฉ', 15000, 'ูุนุงูุฌุฉ', '2024-02-20'],
        [5, 'VIO-2024-005', '2024-03-01', 'ุงูุจูุฏูุฉ', 'ุจูุฆูุฉ', 'ุนุฏู ูุฌูุฏ ุนูุฏ ูุธุงูุฉ', 'ูุงุฆุญุฉ ุงููุธุงูุฉ', 5000, 'ูุงุฆูุฉ', ''],
    ]
    add_data(ws1, 4, violations)
    set_widths(ws1, [5, 15, 12, 18, 15, 30, 20, 12, 12, 15])

    # ===== ูุฑูุฉ 2: ููุฎุต ุงููุฎุงููุงุช =====
    ws2 = wb.create_sheet("ููุฎุต ุงููุฎุงููุงุช")
    ws2.sheet_view.rightToLeft = True

    ws2['A1'] = "ููุฎุต ุงููุฎุงููุงุช ุญุณุจ ุงูุฌูุฉ"
    ws2['A1'].font = TITLE_FONT
    ws2.merge_cells('A1:D1')

    headers2 = ['ุงูุฌูุฉ', 'ุงูุนุฏุฏ', 'ุฅุฌูุงูู ุงูุบุฑุงูุงุช', 'ุงููุงุฆูุฉ']
    for col, h in enumerate(headers2, 1):
        ws2.cell(row=3, column=col, value=h)
    style_header(ws2, 3, len(headers2))

    summary = [
        ['SFDA', 2, 75000, 2],
        ['ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ', 1, 10000, 1],
        ['ุงูุฏูุงุน ุงููุฏูู', 1, 15000, 0],
        ['ุงูุจูุฏูุฉ', 1, 5000, 1],
        ['ุงูุฅุฌูุงูู', 5, 105000, 4],
    ]
    add_data(ws2, 4, summary)
    set_widths(ws2, [20, 12, 18, 12])

    # ===== ูุฑูุฉ 3: ุงูุชุฑุงุฎูุต =====
    ws3 = wb.create_sheet("ุงูุชุฑุงุฎูุต")
    ws3.sheet_view.rightToLeft = True

    ws3['A1'] = "ุณุฌู ุงูุชุฑุงุฎูุต ูุงูุชุตุงุฑูุญ"
    ws3['A1'].font = TITLE_FONT
    ws3.merge_cells('A1:I1')

    headers3 = ['ู', 'ุงูุชุฑุฎูุต', 'ุงูุฑูู', 'ุงูุฌูุฉ', 'ุงูุฅุตุฏุงุฑ', 'ุงูุงูุชูุงุก', 'ุงูุญุงูุฉ', 'ูุชุทูุจุงุช ุงูุชุฌุฏูุฏ', 'ุงูุฑุณูู']
    for col, h in enumerate(headers3, 1):
        ws3.cell(row=3, column=col, value=h)
    style_header(ws3, 3, len(headers3))

    licenses = [
        [1, 'ุงูุณุฌู ุงูุชุฌุงุฑู', '1010XXXXXX', 'ูุฒุงุฑุฉ ุงูุชุฌุงุฑุฉ', '2022-01-01', '2024-01-01', 'ููุชูู', 'ุชุฌุฏูุฏ ุณููู', 1200],
        [2, 'ุงูุฑุฎุตุฉ ุงูุตูุงุนูุฉ', 'IND-XXXXX', 'ูุฒุงุฑุฉ ุงูุตูุงุนุฉ', '2021-06-01', '2024-06-01', 'ููุชูู', 'ุดูุงุฏุฉ ุจูุฆูุฉ', 5000],
        [3, 'ุฑุฎุตุฉ SFDA', 'SFDA-XXXXX', 'ููุฆุฉ ุงูุบุฐุงุก ูุงูุฏูุงุก', '2022-03-01', '2024-03-01', 'ููููู', 'HACCP + ูุญุต', 10000],
        [4, 'ุงูุฏูุงุน ุงููุฏูู', 'CD-XXXXX', 'ุงูุฏูุงุน ุงููุฏูู', '2023-01-01', '2024-01-01', 'ููุชูู', 'ูุนุงููุฉ', 2000],
        [5, 'ุฑุฎุตุฉ ุงูุจูุฏูุฉ', 'MUN-XXXXX', 'ุงูุจูุฏูุฉ', '2023-03-01', '2024-03-01', 'ููุชูู', 'ุณุฌู ุณุงุฑู', 3000],
        [6, 'ุดูุงุฏุฉ ZATCA', 'ZATCA-XXXXX', 'ููุฆุฉ ุงูุฒูุงุฉ', '2023-04-01', '2024-04-01', 'ุณุงุฑู', 'ุฅูุฑุงุฑ ุถุฑูุจู', 0],
        [7, 'ุงูุชุฃูููุงุช', 'GOSI-XXXXX', 'ุงูุชุฃูููุงุช', '2023-01-01', '2024-12-31', 'ุณุงุฑู', 'ุณุฏุงุฏ ุดูุฑู', 0],
    ]
    add_data(ws3, 4, licenses)
    set_widths(ws3, [5, 20, 15, 20, 12, 12, 10, 25, 10])

    # ===== ูุฑูุฉ 4: ุชุญููู ุงููุฌูุฉ =====
    ws4 = wb.create_sheet("ุชุญููู ุงููุฌูุฉ")
    ws4.sheet_view.rightToLeft = True

    ws4['A1'] = "ุชุญููู ุงููุฌูุฉ - ุงููุถุน ุงูุฑุงูู vs ุงููุทููุจ"
    ws4['A1'].font = TITLE_FONT
    ws4.merge_cells('A1:H1')

    headers4 = ['ู', 'ุงููุฌุงู', 'ุงููุชุทูุจ', 'ุงูุฑุงูู', 'ุงููุทููุจ', 'ุงููุฌูุฉ%', 'ุงูุฃููููุฉ', 'ุงูุฅุฌุฑุงุก']
    for col, h in enumerate(headers4, 1):
        ws4.cell(row=3, column=col, value=h)
    style_header(ws4, 3, len(headers4))

    gaps = [
        [1, 'ุงูุชุฑุงุฎูุต', 'ุงูุณุฌู ุงูุชุฌุงุฑู', 'ููุชูู', 'ุณุงุฑู', 100, 'ุญุฑุฌุฉ', 'ุชุฌุฏูุฏ ููุฑู'],
        [2, 'ุงูุชุฑุงุฎูุต', 'ุฑุฎุตุฉ SFDA', 'ููููู', 'ุณุงุฑู', 100, 'ุญุฑุฌุฉ', 'ูุนุงูุฌุฉ ุงููุฎุงููุงุช'],
        [3, 'ุณูุงูุฉ ุงูุบุฐุงุก', 'ูุธุงู HACCP', 'ุบูุฑ ููุฌูุฏ', 'ูุทุจู', 100, 'ุญุฑุฌุฉ', 'ุชุตููู ูุชุทุจูู'],
        [4, 'ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ', 'ุชูุซูู ุงูุนููุฏ', '70%', '100%', 30, 'ุนุงููุฉ', 'ุชูุซูู ุงููุชุจูู'],
        [5, 'ุงูุชุฏุฑูุจ', 'ุณูุงูุฉ ุงูุบุฐุงุก', '30%', '100%', 70, 'ุนุงููุฉ', 'ุจุฑูุงูุฌ ุชุฏุฑูุจ'],
        [6, 'ุงูุจููุฉ ุงูุชุญุชูุฉ', 'ูุนุฏุงุช ุงูุณูุงูุฉ', '60%', '100%', 40, 'ูุชูุณุทุฉ', 'ุดุฑุงุก ูุตูุงูุฉ'],
    ]
    add_data(ws4, 4, gaps)
    set_widths(ws4, [5, 15, 20, 15, 15, 10, 12, 25])

    # ===== ูุฑูุฉ 5: ุงูุนููุจุงุช =====
    ws5 = wb.create_sheet("ุงูุนููุจุงุช ุงููุธุงููุฉ")
    ws5.sheet_view.rightToLeft = True

    ws5['A1'] = "ุฌุฏูู ุงูุนููุจุงุช ุญุณุจ ุงูุฃูุธูุฉ ุงูุณุนูุฏูุฉ"
    ws5['A1'].font = TITLE_FONT
    ws5.merge_cells('A1:F1')

    headers5 = ['ุงููุธุงู', 'ุงููุฎุงููุฉ', 'ุงููุฑุฉ ุงูุฃููู', 'ุงูุชูุฑุงุฑ', 'ุงูุฅุบูุงู', 'ุงููุฑุฌุน']
    for col, h in enumerate(headers5, 1):
        ws5.cell(row=3, column=col, value=h)
    style_header(ws5, 3, len(headers5))

    penalties = [
        ['ูุธุงู ุงูุบุฐุงุก', 'ููุชุฌุงุช ููุชููุฉ', '100,000 ุฑูุงู', '500,000 + ุฅุบูุงู', 'ูุนู', 'ุงููุงุฏุฉ 23'],
        ['ูุธุงู ุงูุบุฐุงุก', 'ุนุฏู ุชุฑุฎูุต', '50,000 ุฑูุงู', '200,000 ุฑูุงู', 'ูุนู', 'ุงููุงุฏุฉ 8'],
        ['ูุธุงู ุงูุบุฐุงุก', 'ุนุฏู HACCP', '50,000 ุฑูุงู', '150,000 ุฑูุงู', 'ูุนู', 'ุงููุงุฏุฉ 15'],
        ['ูุธุงู ุงูุนูู', 'ุนุฏู ุชูุซูู ุงูุนููุฏ', '10,000/ุนุงูู', '20,000/ุนุงูู', 'ูุง', 'ุงููุงุฏุฉ 51'],
        ['ูุธุงู ุงูุนูู', 'ุชุฃุฎูุฑ ุงูุฑูุงุชุจ', '10,000 ุฑูุงู', 'ุฅููุงู ุฎุฏูุงุช', 'ูุง', 'ุงููุงุฏุฉ 90'],
        ['ุงูุฏูุงุน ุงููุฏูู', 'ุนุฏู ุงูุณูุงูุฉ', '20,000 ุฑูุงู', '50,000 + ุฅุบูุงู', 'ูุนู', 'ูุงุฆุญุฉ ุงูุณูุงูุฉ'],
    ]
    add_data(ws5, 4, penalties)
    set_widths(ws5, [15, 20, 18, 22, 10, 15])

    wb.save('01_current_status/01_ุงูุญุงูุฉ_ุงูุฑุงููุฉ.xlsx')
    print("โ ุชู ุฅูุดุงุก: 01_ุงูุญุงูุฉ_ุงูุฑุงููุฉ.xlsx")

def update_risk_management():
    """ุชุญุฏูุซ ููู ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ"""
    wb = load_workbook('06_risk_management/06_ุฅุฏุงุฑุฉ_ุงููุฎุงุทุฑ.xlsx')

    # ุฅุถุงูุฉ ูุฑูุฉ ุณุฌู ุงููุฎุงุทุฑ
    ws = wb.create_sheet("ุณุฌู ุงููุฎุงุทุฑ", 0)
    ws.sheet_view.rightToLeft = True

    ws['A1'] = "ุณุฌู ุงููุฎุงุทุฑ ุงูุดุงูู"
    ws['A1'].font = TITLE_FONT
    ws.merge_cells('A1:I1')

    headers = ['ู', 'ุงููุฎุงุทุฑุฉ', 'ุงููุฆุฉ', 'ุงูุงุญุชูุงู', 'ุงูุฃุซุฑ', 'ุงูุฏุฑุฌุฉ', 'ุงูุชุฎููู', 'ุงููุณุคูู', 'ุงูุญุงูุฉ']
    for col, h in enumerate(headers, 1):
        ws.cell(row=3, column=col, value=h)
    style_header(ws, 3, len(headers))

    risks = [
        [1, 'ุชููุซ ุงูููุชุฌ', 'ุณูุงูุฉ ุบุฐุงุก', 4, 5, 20, 'HACCP + ูุญูุตุงุช', 'ูุฏูุฑ ุงูุฌูุฏุฉ', 'ููุชูุญ'],
        [2, 'ุงููุทุงุน ุงูููุฑุฏ', 'ุณูุณูุฉ ุชูุฑูุฏ', 3, 4, 12, 'ููุฑุฏูู ุจุฏูุงุก', 'ุงููุดุชุฑูุงุช', 'ููุชูุญ'],
        [3, 'ุนุฏู ุงูุงูุชุซุงู', 'ุชูุธููู', 3, 5, 15, 'ูุธุงู ูุฑุงูุจุฉ', 'ูุฏูุฑ ุงูุงูุชุซุงู', 'ููุชูุญ'],
        [4, 'ุญุฑูู', 'ุชุดุบููู', 2, 5, 10, 'ุฅุทูุงุก + ุชุฃููู', 'ูุฏูุฑ ุงูุณูุงูุฉ', 'ููุชูุญ'],
        [5, 'ุงุณุชุฏุนุงุก ููุชุฌ', 'ุณูุนุฉ', 2, 5, 10, 'ุชุชุจุน + ุฅุฌุฑุงุก', 'ูุฏูุฑ ุงูุฌูุฏุฉ', 'ููุชูุญ'],
        [6, 'ุฅุตุงุจุฉ ุนูู', 'ุณูุงูุฉ', 3, 4, 12, 'ุชุฏุฑูุจ + ุญูุงูุฉ', 'ูุฏูุฑ ุงูุณูุงูุฉ', 'ููุชูุญ'],
        [7, 'ุงููุทุงุน ููุฑุจุงุก', 'ุชุดุบููู', 2, 3, 6, 'ูููุฏ ุงุญุชูุงุทู', 'ูุฏูุฑ ุงููุฑุงูู', 'ูุบูู'],
    ]
    add_data(ws, 4, risks)
    set_widths(ws, [5, 20, 15, 10, 10, 10, 25, 18, 12])

    wb.save('06_risk_management/06_ุฅุฏุงุฑุฉ_ุงููุฎุงุทุฑ.xlsx')
    print("โ ุชู ุชุญุฏูุซ: 06_ุฅุฏุงุฑุฉ_ุงููุฎุงุทุฑ.xlsx")

def update_labor_courts():
    """ุชุญุฏูุซ ูุนูููุงุช ุงููุญุงูู ุงูุนูุงููุฉ"""
    wb = load_workbook('02_regulatory_framework/02_ุงูุฅุทุงุฑ_ุงูุชูุธููู.xlsx')

    # ุงูุจุญุซ ุนู ูุฑูุฉ ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ ูุชุญุฏูุซูุง
    if 'hrsd requirements' in wb.sheetnames:
        ws = wb['hrsd requirements']

        # ุชุญุฏูุซ ุงูุนููุงู
        ws['A1'] = "ูุชุทูุจุงุช ูุฒุงุฑุฉ ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ - ูุธุงู ุงูุนูู ูุงููุญุงูู ุงูุนูุงููุฉ"
        ws['A1'].font = TITLE_FONT

    # ุฅุถุงูุฉ ูุฑูุฉ ุฌุฏูุฏุฉ ูููุญุงูู ุงูุนูุงููุฉ
    ws_new = wb.create_sheet("ุงููุญุงูู ุงูุนูุงููุฉ")
    ws_new.sheet_view.rightToLeft = True

    ws_new['A1'] = "ุงููุญุงูู ุงูุนูุงููุฉ - ุงููุธุงู ุงูุฌุฏูุฏ (2023)"
    ws_new['A1'].font = TITLE_FONT
    ws_new.merge_cells('A1:G1')

    ws_new['A3'] = "ููุงุญุธุฉ: ุชู ุฅูุบุงุก ููุฆุงุช ุชุณููุฉ ุงูุฎูุงูุงุช ุงูุนูุงููุฉ ูุฅูุดุงุก ุงููุญุงูู ุงูุนูุงููุฉ"
    ws_new['A3'].font = SUBTITLE_FONT
    ws_new.merge_cells('A3:G3')

    headers = ['ุงููุฑุญูุฉ', 'ุงูุฌูุฉ', 'ุงูุงุฎุชุตุงุต', 'ุงููุฏุฉ', 'ุงูุฑุณูู', 'ุงูุงุณุชุฆูุงู', 'ููุงุญุธุงุช']
    for col, h in enumerate(headers, 1):
        ws_new.cell(row=5, column=col, value=h)
    style_header(ws_new, 5, len(headers))

    courts = [
        ['ุงูุชุณููุฉ ุงููุฏูุฉ', 'ููุชุจ ุงูุนูู', 'ูุญุงููุฉ ุงูุตูุญ ุงูุฅูุฒุงูู', '21 ููู', 'ูุฌุงูุงู', 'ุงููุญููุฉ ุงูุนูุงููุฉ', 'ุฅูุฒุงูู ูุจู ุงูุฏุนูู'],
        ['ุงูุฏุฑุฌุฉ ุงูุฃููู', 'ุงููุญููุฉ ุงูุนูุงููุฉ', 'ุงููุธุฑ ูู ุงูุฏุนูู', 'ูุชุบูุฑ', 'ูุฌุงูุงู', 'ุงูุงุณุชุฆูุงู', 'ุญูู ุงุจุชุฏุงุฆู'],
        ['ุงูุงุณุชุฆูุงู', 'ูุญููุฉ ุงูุงุณุชุฆูุงู ุงูุนูุงููุฉ', 'ุงุณุชุฆูุงู ุงูุญูู', '30 ููู ููุชูุฏูู', 'ูุฌุงูุงู', 'ุงูุนููุง (ูุญุฏูุฏ)', 'ุญูู ููุงุฆู ุบุงูุจุงู'],
        ['ุงูุชูููุฐ', 'ูุญููุฉ ุงูุชูููุฐ', 'ุชูููุฐ ุงูุญูู', 'ููุฑู', 'ูุฌุงูุงู', '-', 'ุจุนุฏ ุงูุชุณุงุจ ุงููุทุนูุฉ'],
    ]
    add_data(ws_new, 6, courts)

    ws_new['A12'] = "ุงููุฑููุงุช ุนู ุงููุธุงู ุงูุณุงุจู:"
    ws_new['A12'].font = SUBTITLE_FONT

    differences = [
        "โข ุงููุญุงูู ุงูุนูุงููุฉ ุฌุฒุก ูู ุงููุถุงุก ุงูุนุงู ูููุณุช ููุฆุงุช ุฅุฏุงุฑูุฉ",
        "โข ุงููุถุงุฉ ูุนูููู ุจูุฑุงุณูู ููููุฉ",
        "โข ุงูุฃุญูุงู ููุฒูุฉ ููุงุจูุฉ ููุชูููุฐ ูุจุงุดุฑุฉ",
        "โข ุงูุชูุงุถู ุงูุฅููุชุฑููู ุนุจุฑ ูุงุฌุฒ",
        "โข ูุฏุฏ ุงูุชูุงุถู ุฃูุตุฑ ูุฃูุซุฑ ุชุญุฏูุฏุงู",
    ]
    for i, diff in enumerate(differences, 13):
        ws_new[f'A{i}'] = diff
        ws_new[f'A{i}'].alignment = RTL_ALIGN

    set_widths(ws_new, [18, 22, 28, 18, 12, 20, 25])

    # ุชุญุฏูุซ ูุฑูุฉ ุงูุชุธููุงุช ุฅุฐุง ูุฌุฏุช
    for sheet_name in wb.sheetnames:
        if 'ุงูููุงุฑุฏ' in sheet_name or 'hrsd' in sheet_name.lower():
            ws = wb[sheet_name]
            # ุงูุจุญุซ ุนู "ููุฆุงุช" ูุงุณุชุจุฏุงููุง ุจู "ูุญุงูู"
            for row in ws.iter_rows():
                for cell in row:
                    if cell.value and isinstance(cell.value, str):
                        if 'ููุฆุฉ' in cell.value and 'ุนูุงู' in cell.value.lower():
                            cell.value = cell.value.replace('ููุฆุฉ', 'ูุญููุฉ').replace('ุงูููุฆุฉ', 'ุงููุญููุฉ')
                        if 'ุงูููุฆุงุช ุงูุนูุงููุฉ' in cell.value:
                            cell.value = cell.value.replace('ุงูููุฆุงุช ุงูุนูุงููุฉ', 'ุงููุญุงูู ุงูุนูุงููุฉ')

    wb.save('02_regulatory_framework/02_ุงูุฅุทุงุฑ_ุงูุชูุธููู.xlsx')
    print("โ ุชู ุชุญุฏูุซ: 02_ุงูุฅุทุงุฑ_ุงูุชูุธููู.xlsx (ุงููุญุงูู ุงูุนูุงููุฉ)")

if __name__ == "__main__":
    os.chdir('/home/user/chtgpt/food_factory_compliance')

    print("="*60)
    print("ุฅุตูุงุญ ูุชุญุฏูุซ ุงููููุงุช")
    print("="*60)

    print("\n๐ ุฅุตูุงุญ ููู ุงูุญุงูุฉ ุงูุฑุงููุฉ...")
    create_current_status()

    print("\n๐ ุชุญุฏูุซ ููู ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ...")
    update_risk_management()

    print("\n๐ ุชุญุฏูุซ ูุนูููุงุช ุงููุญุงูู ุงูุนูุงููุฉ...")
    update_labor_courts()

    print("\n" + "="*60)
    print("โ ุชู ุงูุฅุตูุงุญ ูุงูุชุญุฏูุซ ุจูุฌุงุญ!")
    print("="*60)
